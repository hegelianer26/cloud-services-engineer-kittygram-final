## Проект Cоздание виртуальной инфраструктуры для Kittygram
Проект по автоматизации развертывания инфраструктуры в Яндекс Облаке и настройке CI/CD для приложения Kittygram с использованием GitHub Actions, Terraform и Docker.

## Описание проекта
Kittygram - это веб-приложение для любителей кошек, где пользователи могут делиться фотографиями своих питомцев. Проект состоит из:

- Backend на Django REST Framework
- Frontend на React
- Nginx в качестве веб-сервера и обратного прокси

Инфраструктура проекта автоматически разворачивается в Яндекс Облаке с помощью Terraform, а CI/CD процесс настроен с использованием GitHub Actions.

## Инфраструктура
С помощью Terraform создаются следующие ресурсы в Яндекс Облаке:

- Виртуальная частная сеть (VPC)
- Группа безопасности (Security Group) с настроенными правилами для портов 22 (SSH) и 80/443 (HTTP/HTTPS)
- Виртуальная машина с предустановленным Docker и необходимыми зависимостями (через cloud-init)

Terraform state хранится в предварительно созданном S3-бакете в Object Storage Яндекс Облака

## CI/CD процесс

### Terraform Workflow

Workflow terraform.yml позволяет управлять инфраструктурой через GitHub Actions:

- plan: Предварительный просмотр изменений инфраструктуры
- apply: Создание или обновление инфраструктуры
- destroy: Удаление всей инфраструктуры

### Kittygram Workflow

Workflow kittygram_workflow.yml автоматизирует процесс деплоя приложения:

- Проверка кода на соответствие PEP8
- Запуск автотестов
- Сборка Docker-образов и публикация на Docker Hub
- Деплой на сервер с использованием Docker Compose
- Настройка статики и выполнение миграций
- Отправка уведомления в Telegram о успешном деплое

## Как использовать 

### Предварительные требования
- Аккаунт в Яндекс Облаке с активированным сервисом Yandex Compute Cloud
- S3 хранилище в Яндекс Облаке
- Аккаунт на Docker Hub
- Репозиторий на GitHub
- Настроенные секреты GitHub для доступа к Яндекс Облаку и Docker Hub

### НАстройка секретов GitHub Action

Для работы CI/CD необходимо добавить следующие секреты в настройках репозитория:

- `YC_CLOUD_ID`: ID облака в Яндекс Облаке
- `YC_FOLDER_ID`: ID каталога в Яндекс Облаке
- `YC_SERVICE_ACCOUNT_KEY`: JSON ключ сервисного аккаунта (сохраняется в key.json)
- `YC_ACCESS_KEY_ID`: Access key для доступа к S3
- `YC_SECRET_ACCESS_KEY`: Secret key для доступа к S3
- `DEPLOY_SECRET_SSH_KEY`: Приватный SSH-ключ для доступа к серверу
- `DEPLOY_SSH_USER` → Имя пользователя для SSH подключения (обычно git_hub_user)
- `ADMIN_SSH_KEY`: Публичный SSH-ключ администратора
- `SSH_SERVER_IP`: IP-адрес сервера (вводится после создания инфраструктуры и берется из артефактов)
- `DOCKER_USERNAME`: Имя пользователя Docker Hub
- `DOCKER_PASSWORD`: Пароль от Docker Hub
- `TELEGRAM_TO: ID` чата в Telegram
- `TELEGRAM_TOKEN`: Токен бота Telegram

### Запуск инфраструктуры
1. Перейдите на вкладку Actions в репозитории
2. Выберите workflow "Terraform Trigger Workflow"
3. Нажмите "Run workflow"
4. Выберите действие (plan, apply или destroy)
5. Дождитесь завершения выполнения

После успешного создания инфраструктуры, IP-адрес виртуальной машины будет доступен в артефактах workflow и отправлен в Telegram.

### Деплой приложения
Деплой приложения происходит автоматически при пуше в ветку main или может быть запущен вручную через GitHub Actions.

### Демо
Проект доступен по адресу: http://51.250.0.143/
